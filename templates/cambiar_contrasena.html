{% extends 'base.html' %}
{% block title %}Cambiar Contraseña{% endblock %}
{% block body_class %}form-body{% endblock %}
{% block content %}
<div class="form-container">
    <header class="main-header-form">
        <img src="{{ url_for('static', filename='images/logo_uls_blanco.png') }}" alt="Logo ULS" class="logo">
    </header>
    <h2>Cambiar mi Contraseña</h2>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="post" novalidate>
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.old_password.label }}
            {{ form.old_password(class='form-control') }}
        </div>
        <div class="form-group">
            {{ form.new_password.label }}
            {{ form.new_password(class='form-control') }}
        </div>
        <div class="form-group">
            {{ form.confirm_password.label }}
            {{ form.confirm_password(class='form-control') }}
        </div>
        {{ form.submit(class='btn-submit') }}
    </form>
    
    {% if current_user.rol == 'staff' %}
        <a href="{{ url_for('panel') }}" class="link-volver">Volver al Panel</a>
    {% elif current_user.rol == 'registrador' %}
        <a href="{{ url_for('registro') }}" class="link-volver">Volver al Registro</a>
    {% elif current_user.rol == 'admin' %}
         <a href="{{ url_for('admin_dashboard') }}" class="link-volver">Volver al Dashboard</a>
    {% endif %}
</div>
{% endblock %}